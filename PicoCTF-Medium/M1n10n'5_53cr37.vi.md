### **Thử thách M1n10n'5_53cr37 của Prince Niyonshuti N.**

  * **Tác giả:** SyerexX
  * **Ngày:** 19/10/2025
  * **Thể loại:** Reverse Engineering

Sau khi đã khởi động với vài thử thách "Easy", mình quyết định thử sức với một bài "Medium" mang tên **M1n10n'5_53cr37**. Thử thách này thuộc lĩnh vực Dịch ngược (Reverse Engineering) và yêu cầu phân tích một file ứng dụng Android (`.apk`). Trái ngược với dự đoán, phần khó nhất của bài này không phải là việc tìm flag, mà là cuộc chiến với chính các công cụ và môi trường làm việc.
-----
### **1. Giai đoạn 1: Thử Thách với Môi trường & Công cụ**
Đây là giai đoạn gian nan nhất nhưng cũng là nơi mình học được nhiều nhất về gỡ lỗi.
  * **Vấn đề ban đầu:** Khi sử dụng phiên bản `jadx` cài đặt qua `apt`, nó liên tục gặp lỗi: không tìm thấy file, không có quyền tạo thư mục, và cuối cùng là tạo ra thư mục output trống không.
  * **Giải pháp:** Sau hàng loạt các bước gỡ lỗi (sử dụng `sudo`, đổi đường dẫn, kiểm tra quyền...), mình nhận ra vấn đề nằm ở chính phiên bản `jadx` từ `apt`. Giải pháp cuối cùng là:
    1.  **Làm việc trong "phòng sạch":** Sao chép file `minions.apk` vào thư mục "nhà" của Linux (`~`) để tránh mọi xung đột quyền với Windows.
    2.  **Cài đặt thủ công:** Tải phiên bản `jadx` mới nhất trực tiếp từ GitHub.
    3.  **Cài đặt Dependency:** Cài đặt Java (`default-jdk`) để `jadx` có thể hoạt động.

  * **Bài học:** Môi trường làm việc cũng là một phần của thử thách. Khi một công cụ không hoạt động, đừng ngại gỡ bỏ và tìm một phiên bản khác ổn định hơn. Luôn kiểm tra các phần phụ thuộc (dependencies) của công cụ.

-----

### **2. Mổ xẻ & Lần theo Dấu vết**
Sau khi đã có công cụ `jadx` hoạt động ổn định, cuộc điều tra thực sự bắt đầu.

  * **Bước 1: Dịch ngược file APK**
    Sử dụng phiên bản `jadx` đã tải về để dịch ngược file `minions.apk`.
    ```bash
    # Chạy từ thư mục chứa jadx và file apk
    ./jadx-1.4.7/bin/jadx -d Minionsapp-source minions.apk
    ```

    Lệnh này đã tạo ra thành công thư mục `Minionsapp-source` chứa mã nguồn ứng dụng.

  * **Bước 2: Thay đổi Chiến lược**
    Ban đầu, mình dùng `grep` để tìm các từ khóa "picoCTF", "flag"... nhưng không có kết quả. Đúng lúc này, hint của tác giả "Any interesting source files?" đã chỉ ra một hướng đi mới: ngừng tìm nội dung, hãy tìm **tên file**.

  * **Bước 3: Tìm "File thú vị"**
    Mình dùng `find .` để liệt kê toàn bộ cây thư mục và `grep -v` để lọc bỏ nhiễu. Giữa hàng trăm file hệ thống, một file nổi bật lên: `sources/com/example/picoctfimage/MainActivity.java`. Đây chính là file mã nguồn do tác giả viết.

  * **Bước 4: Lần theo Sợi chỉ**
    Tuy nhiên, `MainActivity.java` lại là một "mồi nhử" khác, nó chỉ chứa code mặc định. Nhưng một dòng code trong đó lại là chìa khóa: `setContentView(R.layout.activity_main)`. Dòng này liên kết đến file giao diện `activity_main.xml`.
    Kiểm tra file `activity_main.xml`, mình tìm thấy một gợi ý trực tiếp được viết trong một `TextView`: `"Look into me my Banana Value is interesting"`.

  * **Bước 5: Manh mối Cuối cùng**
    Gợi ý "Banana Value" dẫn mình đến file `strings.xml` (nơi chứa các giá trị chuỗi). Và đúng như dự đoán, bên trong có một chuỗi tên là "Banana".

    ```xml
    <string name="Banana">OBUWG32DKRDHWMLUL53TI43OG5PWQNDSMRPXK3TSGR3DG3BRNY4V65DIGNPW2MDCGFWDGX3DGBSDG7I=</string>
    ```

-----

### **3. Giải mã & Kết quả**

Chuỗi ký tự trên có đầy đủ dấu hiệu của mã hóa **Base32** (chỉ có chữ hoa, số 2-7, và kết thúc bằng `=`). Mình dùng lệnh `base32 -d` để giải mã.

```bash
echo "OBUWG32DKRDHWMLUL53TI43OG5PWQNDSMRPXK3TSGR3DG3BRNY4V65DIGNPW2MDCGFWDGX3DGBSDG7I=" | base32 -d
```

Và flag cuối cùng đã xuất hiện: **`picoCTF{1t_w4sn7_h4rd_unr4v3l1n9_th3_m0b1l3_c0d3}`**

-----
### **4. Bài học rút ra**

  * Thử thách này dạy mình một quy trình đầy đủ để dịch ngược một ứng dụng Android: từ việc gỡ lỗi môi trường, phân tích cây thư mục, lần theo sự liên kết giữa code Java và tài nguyên XML, cho đến bước giải mã cuối cùng.
  * Quan trọng nhất, nó cho thấy kỹ năng gỡ lỗi và sự kiên trì còn quan trọng hơn cả việc biết trước đáp án. Mỗi lỗi sai đều là một bài học để tiến gần hơn đến kết quả.
